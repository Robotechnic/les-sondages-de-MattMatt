<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="UTF-8">
	<title>Les sondages de MattMatt - Edition</title>
	<%- include ("parts/include.ejs") %>
</head>
<body>
	<%- include ("parts/header.ejs") %>
	<section class="sondage-header">
		<div class="sondage-header__info-contener">
			<% if (data.password) {%><div class="sondage-header__info-contener__password">Mot de passe: <%=data.password%></div><%}%>
			<div class="sondage-header__info-contener__date"><%=data.creationDate%></div>
		</div>
		<h2 class="sondage-header__title"><%=data.title%></h2>
		<p class="sondage-header__description"><%-data.description.replace(/\n/g,"<br/>")%></p>
		<a class="sondage-header__edit" id="editButton" href="#editParams">Éditer</a>
	</section>
	<section class="form-contener-column">
		<nav class="form-contener__form" method="POST" action="">
			<% if (locals.questions) {
				questions.forEach((question,index)=>{%>
					<div class="presentationComponent">
						<h3 class="presentationComponent__title"><%=question.question%></h3>
						<div class="presentationComponent__content-extended">
							<ol class="presentationComponent__content__list">
								<% var temp = question.choix.split("\n")
								temp.forEach((choix,indexChoix)=>{
									switch (questions[i].type) {
										case "single":%>
											<li>
												<input 	type="radio" 
														name="test"
														required 
														name="responseFor<%=question.id%>" 
														id="responseFor<%=question.id%>_<%=indexChoix%>">
												<label For="responseFor<%=question.id%>_<%=indexChoix%>">
													<%=choix%>
												</label>
											</li>
										<% break;
										case "multiple":%>
												<input 	type="radio" 
														name="test"
														required 
														name="responseFor<%=question.id%>" 
														id="responseFor<%=question.id%>_<%=indexChoix%>">
												<label For="responseFor<%=question.id%>_<%=indexChoix%>">
													<%=choix%>		
												</label>
										<%break;
									}
								})%>
							</ol>
						</div>
					</div>
			<%	})
			}%>
		</nav>
		<button class="addQuestion">
			+
		</button>
	</section>
	<section class="form-contener" id="editParams">
		<a href="#" class="closeLink">❌</a>
		<h2>Configuration: <%=data.title%></h2>
		<form class="form-contener__form" method="POST" action="/gestion/edit/description/<%=data.id%>?token=<%=token%>">
			<label For="description">Description:</label>
			<textarea id="description"  placeholder="Description" name="description"><%=data.description%></textarea>
			<input type="submit" name="submit" value="Enregistrer">
		</form>
		<form class="form-contener__form" method="POST" action="/gestion/edit/password/<%=data.id%>?token=<%=token%>">
			<input type="checkbox" name="passwordCheckBox" id="passwordCheckBox" <%if (data.passwordNeeded) {%>checked<%}%>>
			<label For="passwordCheckBox" class="checkboxLabel">Mot de passe requis</label>
			<div class="form-contener__form__passwordContener">
				<label For="password">Mot de passe:</label>
				<input 	type="text" 
						name="password" 
						id="password" 
						minlength="8"
						placeholder="Mot de passe"
						value="<%=data.password%>" 
				>
				<div class="instruction-contener">
					<label 	class="instruction-contener__instruction" 
							id="passwordNumberValidator">Le mot de passe contient un nombre</label>
					<label 	class="instruction-contener__instruction"
							id="passwordMajValidator">Le mot de passe contient une majuscule</label>
					<label 	class="instruction-contener__instruction"
							id="passwordMinValidator">Le mot de passe contient une minuscule</label>
					<label 	class="instruction-contener__instruction"
							id="passwordSpetialValidator">Le mot de passe contient un caractère<br/> spétial (*.! @#$%^&(){}[]:;<>,.?/~_+-=|\)</label>
					<label 	class="instruction-contener__instruction"
							id="passwordLengthValidator">Le mot de passe fait au moins 8 caractères</label>
				</div>
			</div>
			<input type="submit" name="submit" value="Enregistrer">
		</form>
	</section>
	<%- include ("parts/footer.ejs") %>

	<script type="text/javascript" src="/js/editSondage.js"></script>
	<!-- Error script-->
	<script type="text/javascript"> 
		<% if (locals.error) {%>
			alert("<%=error%>")
		<% } %>
	</script>
</body>
</html>